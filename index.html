<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Wynand Janse van Rensburg - IT Developer & Student | CV Portfolio</title>
<meta name="description" content="IT enthusiast and BSc Information Technology student from Riversdale, South Africa. Skilled in Python, Java, JavaScript, C#, web development, and systems analysis."/>
<meta name="keywords" content="IT developer, software engineer, Python, Java, JavaScript, web development, South Africa, Riversdale"/>
<meta name="author" content="Wynand Janse van Rensburg"/>

<!-- Open Graph -->
<meta property="og:title" content="Wynand Janse van Rensburg - IT Developer & Student"/>
<meta property="og:description" content="IT enthusiast and BSc Information Technology student from Riversdale, South Africa."/>
<meta property="og:type" content="website"/>

<link href="/favicon.ico" rel="icon" type="image/x-icon"/>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/typed.js/2.0.12/typed.min.js"></script>
<script>tailwind.config = {darkMode: 'class'}</script>
<style>
html { scroll-behavior: smooth; }
body { transition: background 2s ease-in-out; position: relative; }

.section { opacity: 0; transform: translateY(20px); transition: all 1s ease-in-out; }
.section.visible { opacity: 1; transform: translateY(0); }

/* Lamp Styles */
.lamp-container {
  position: fixed; top: 0; right: 50px; width: 80px; z-index: 60;
  display: flex; flex-direction: column; align-items: center;
}

.bulb {
  width: 48px; height: 48px; background: #ffd700; border-radius: 50%;
  box-shadow: 0 0 40px #ffd700; border: 2px solid #b89500; transition: all 0.3s;
}
.dark .bulb { background: #444; box-shadow: none; border-color: #666; }

#cordSvg {
  overflow: visible; cursor: grab; touch-action: none; width: 48px; height: 300px;
}
#cordWithHandle { fill: #fbbf24; stroke: #f59e0b; stroke-width: 2; cursor: grab; }
.dark #cordWithHandle { stroke: #fbbf24; fill: #fcd34d; }

/* Mobile Toggle */
.toggle-switch { width: 44px; height: 24px; padding: 2px; }
.toggle-lever { width: 40px; height: 20px; border-radius: 2px; background: #e5e7eb; transition: background-color 0.3s; }
.dark .toggle-lever { background: #4b5563; }
.toggle-handle {
  background: #fff; width: 16px; height: 16px; border-radius: 2px; position: absolute;
  top: 2px; left: 2px; transition: transform 0.3s; box-shadow: 0 1px 2px rgba(0,0,0,0.2);
}
#mobileToggle:checked ~ .toggle-lever { background: #fbbf24; }
#mobileToggle:checked ~ .toggle-lever .toggle-handle { transform: translateX(20px); }

@media (max-width: 640px) {
  .lamp-container { right: 20px; }
  #cordSvg { height: 360px; }
  .bulb { width: 40px; height: 40px; }
}

/* Weather Backgrounds */
.weather-clear { background: linear-gradient(to top, #87cefa, #e0f7fa); }
.weather-cloudy { background: linear-gradient(135deg, #636e72, #2d3436, #b2bec3); }
.weather-rain, .weather-thunderstorm { background: linear-gradient(135deg, #74b9ff, #0984e3, #2d3436); }
.weather-snow { background: linear-gradient(135deg, #ddefff, #ffffff, #e8f4fd); }

.weather-cloudy, .weather-rain, .weather-thunderstorm, .weather-snow {
  background-size: 400% 400%; animation: gradientShift 30s ease infinite;
}
@keyframes gradientShift { 0%, 100% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } }

/* Weather Effects */
.weather-clear::before {
  content: ""; position: fixed; top: 5%; right: 10%; width: 120px; height: 120px; z-index: -1;
  background: radial-gradient(circle, rgba(255,223,0,0.8) 30%, rgba(255,193,7,0.4) 70%, transparent);
  border-radius: 50%; animation: sunRotate 20s linear infinite, sunPulse 4s ease-in-out infinite;
}
@keyframes sunRotate { to { transform: rotate(360deg); } }
@keyframes sunPulse { 0%, 100% { transform: scale(1); opacity: 0.8; } 50% { transform: scale(1.1); opacity: 1; } }

/* Rain Effects */
.weather-rain::before, .weather-thunderstorm::before {
  content: ""; position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;
  background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 300"><path d="M80 90 C75 90, 72 85, 75 80 L78 65 C78 60, 82 60, 82 65 L85 80 C88 85, 85 90, 80 90 Z" fill="rgba(100,180,255,0.7)" /></svg>') repeat;
  background-size: 300px; animation: raindrops 3s linear infinite;
}
.weather-rain::after, .weather-thunderstorm::after {
  content: ""; position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -2;
  background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 350 350"><path d="M120 105 C115 105, 112 100, 115 95 L118 80 C118 75, 122 75, 122 80 L125 95 C128 100, 125 105, 120 105 Z" fill="rgba(80,160,255,0.5)" /></svg>') repeat;
  background-size: 350px; animation: raindrops 2.8s linear infinite;
}
@keyframes raindrops { from { transform: translateY(-200px) translateX(-20px); } to { transform: translateY(calc(100vh + 200px)) translateX(20px); } }

/* Lightning for thunderstorms */
.weather-thunderstorm::after { animation: raindrops 2.8s linear infinite, lightning 8s infinite; }
@keyframes lightning {
  0%, 85%, 100% { opacity: 0.5; }
  86%, 88% { opacity: 0.9; filter: brightness(1.5); }
}

/* Snow */
.weather-snow::before {
  content: "‚ùÑ ‚ùÖ ‚ùÜ ‚ùÑ ‚ùÖ ‚ùÜ ‚ùÑ ‚ùÖ ‚ùÜ ‚ùÑ ‚ùÖ ‚ùÜ"; position: fixed; top: -100px; left: 0; width: 100%; z-index: -1;
  height: calc(100vh + 200px); font-size: 20px; color: rgba(255,255,255,0.8); overflow: hidden;
  animation: snowfall 12s linear infinite;
}
@keyframes snowfall { to { transform: translateY(calc(100vh + 100px)) translateX(50px) rotate(360deg); } }

/* Clouds */
.weather-cloudy::before, .weather-cloudy::after {
  content: ""; position: fixed; left: 0; width: 100%; z-index: -1;
  background-repeat: repeat-x; animation: cloudsDrift1 45s linear infinite;
}
.weather-cloudy::before {
  top: 15%; height: 200px; background-size: 400px 100px;
  background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 100"><path d="M50 60 C20 60, 20 20, 50 20 C50 10, 70 0, 90 10 C110 0, 130 10, 130 20 C160 20, 160 60, 130 60 Z" fill="rgba(160,160,160,0.7)" /></svg>');
}
.weather-cloudy::after {
  top: 25%; height: 150px; background-size: 450px 80px; z-index: -2;
  background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 350 80"><path d="M70 55 C40 55, 40 25, 70 25 C70 15, 90 5, 110 15 C130 5, 150 15, 150 25 C180 25, 180 55, 150 55 Z" fill="rgba(180,180,180,0.5)" /></svg>');
  animation: cloudsDrift1 55s linear infinite reverse;
}
@keyframes cloudsDrift1 { to { transform: translateX(calc(100vw + 400px)); } }
</style>
</head>

<body class="bg-gray-100 dark:bg-black font-sans text-gray-800 dark:text-gray-200">

<!-- Lamp Toggle -->
<div class="lamp-container hidden sm:flex">
  <div class="bulb"></div>
  <svg id="cordSvg" viewBox="0 0 48 300" xmlns="http://www.w3.org/2000/svg" tabindex="0">
    <rect x="0" y="140" width="48" height="160" fill="transparent" pointer-events="all"></rect>
    <path id="cordWithHandle"></path>
  </svg>
</div>

<!-- Header -->
<header class="bg-gradient-to-r from-red-600 to-red-800 text-white py-8 text-center">
  <h1 class="text-2xl sm:text-3xl md:text-5xl font-bold">
    <span id="typed-text"></span>
  </h1>
  <p class="mt-2 text-lg">IT Enthusiast | Riversdale, South Africa</p>
</header>

<!-- Navigation -->
<nav class="bg-black text-white py-4 sticky top-0 z-10 shadow-lg">
  <div class="container mx-auto px-4">
    <div class="flex items-center justify-between">
      <div class="flex items-center space-x-3">
        <div class="text-lg font-semibold">Wynand</div>
        <div id="weather-info" class="text-xs bg-gray-800 dark:bg-gray-700 px-2 py-1 rounded-full border border-gray-600 text-gray-300 dark:text-gray-400 hidden sm:block"></div>
      </div>

      <div class="hidden md:flex space-x-4 absolute left-1/2 transform -translate-x-1/2">
        <a href="#home" class="hover:text-red-400 transition-colors">Home</a>
        <a href="#objective" class="hover:text-red-400 transition-colors">Objective</a>
        <a href="#education" class="hover:text-red-400 transition-colors">Education</a>
        <a href="#skills" class="hover:text-red-400 transition-colors">Skills</a>
        <a href="#projects" class="hover:text-red-400 transition-colors">Projects</a>
        <a href="#contact" class="hover:text-red-400 transition-colors">Contact</a>
      </div>

      <button id="menuToggle" class="md:hidden focus:outline-none">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
      </button>
    </div>

    <!-- Mobile Dark Mode Toggle -->
    <div class="md:hidden flex items-center justify-center" style="height: 40px;">
      <label for="mobileToggle" class="flex items-center cursor-pointer">
        <div class="toggle-switch relative bg-gray-200 dark:bg-gray-700 rounded border border-gray-300 dark:border-gray-600 shadow-inner">
          <input type="checkbox" id="mobileToggle" class="sr-only"/>
          <div class="toggle-lever rounded-sm relative">
            <div class="toggle-handle"></div>
          </div>
        </div>
        <span class="ml-2 text-xs text-gray-600 dark:text-gray-400">üåô</span>
      </label>
    </div>

    <div class="md:hidden flex justify-center mt-2">
      <div id="weather-info-mobile" class="text-xs bg-gray-800 px-2 py-1 rounded-full border border-gray-600 text-gray-300"></div>
    </div>

    <div id="navLinks" class="md:hidden flex flex-col items-center space-y-2 mt-4 hidden">
      <a href="#home" class="hover:text-red-400 transition-colors">Home</a>
      <a href="#objective" class="hover:text-red-400 transition-colors">Objective</a>
      <a href="#education" class="hover:text-red-400 transition-colors">Education</a>
      <a href="#skills" class="hover:text-red-400 transition-colors">Skills</a>
      <a href="#projects" class="hover:text-red-400 transition-colors">Projects</a>
      <a href="#contact" class="hover:text-red-400 transition-colors">Contact</a>
    </div>
  </div>
</nav>

<!-- Main Content -->
<div class="container mx-auto sm:px-2 px-4 py-8 max-w-3xl">

  <!-- Welcome -->
  <section id="home" class="section bg-white dark:bg-gray-900 rounded-lg shadow-lg p-6 mb-8 border-l-4 border-red-600">
    <h2 class="text-3xl font-semibold mb-4 text-red-600 dark:text-red-400">Welcome</h2>
    <p class="text-base sm:text-lg">I'm Wynand Janse van Rensburg, a passionate IT student and developer. This CV website, self hosted on a Raspberry Pi 4B, showcases my skills, projects, and aspirations in the field of Information Technology.</p>
    <p class="text-base sm:text-lg">Want a secret challenge? <a href="secret.html" style="text-decoration: underline;">Click here</a> if you dare!</p>
  </section>

  <!-- Objective -->
  <section id="objective" class="section bg-white dark:bg-gray-900 rounded-lg shadow-lg p-6 mb-8 border-l-4 border-red-600">
    <h2 class="text-3xl font-semibold mb-4 text-red-600 dark:text-red-400">Career Objective</h2>
    <p class="text-base sm:text-lg">I am driven to advance my skill set to deliver impactful solutions in IT environments. With coding experience in multiple languages, extensive hardware knowledge, and a solid foundation in systems analysis and IT infrastructure, I aim to contribute both practical and creative solutions to innovative projects.</p>
  </section>

  <!-- Education -->
  <section id="education" class="section bg-white dark:bg-gray-900 rounded-lg shadow-lg p-6 mb-8 border-l-4 border-red-600">
    <h2 class="text-3xl font-semibold mb-4 text-red-600 dark:text-red-400">Education</h2>
    <p class="text-base sm:text-lg"><strong>BSc in Information Technology</strong><br/>North-West University, 2023‚Äî2025</p>
  </section>

  <!-- Skills -->
  <section id="skills" class="section bg-white dark:bg-gray-900 rounded-lg shadow-lg p-6 mb-8 border-l-4 border-red-600">
    <h2 class="text-3xl font-semibold mb-4 text-red-600 dark:text-red-400">Skills</h2>
    <ul class="grid grid-cols-1 md:grid-cols-2 gap-4 text-base sm:text-lg">
      <li><strong>Programming Languages:</strong> Python, Java, JavaScript, C#, C++</li>
      <li><strong>Web Development:</strong> HTML, CSS, React</li>
      <li><strong>Systems Analysis:</strong> Proficient in analyzing and designing IT systems</li>
      <li><strong>Databases:</strong> SQL, Oracle</li>
      <li><strong>Tools & Platforms:</strong> Git, GitHub, Visual Studio Code, Node.js, Eclipse</li>
      <li><strong>IT Infrastructure:</strong> Hardware setup, diagnostics, Networking basics</li>
      <li><strong>Soft Skills:</strong> Problem-solving, adaptability, communication, teamwork</li>
      <li><strong>Operating Systems:</strong> Windows, Linux</li>
    </ul>
  </section>

  <!-- Projects -->
  <section id="projects" class="section bg-white dark:bg-gray-900 rounded-lg shadow-lg p-6 mb-8 border-l-4 border-red-600">
    <h2 class="text-3xl font-semibold mb-4 text-red-600 dark:text-red-400">Projects</h2>
    <p class="text-base sm:text-lg">Explore my work on GitHub:
      <a href="https://github.com/WynandJvR?tab=repositories" target="_blank" rel="noopener noreferrer" class="text-red-600 hover:underline">github.com/WynandJvR</a>
    </p>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-4">
      <div class="bg-gray-50 dark:bg-black p-4 rounded-lg shadow hover:shadow-xl transition-shadow border border-red-200 dark:border-red-800">
        <h3 class="text-xl font-semibold text-red-600 dark:text-red-400">Expense Tracker App</h3>
        <p>A Java-based application that tracks a user's expenses and gives real-time analytics.</p>
      </div>
      <div class="bg-gray-50 dark:bg-black p-4 rounded-lg shadow hover:shadow-xl transition-shadow border border-red-200 dark:border-red-800">
        <h3 class="text-xl font-semibold text-red-600 dark:text-red-400">Chat Application</h3>
        <p>A real-time chat app with server-client architecture, featuring robust connection handling.</p>
      </div>
    </div>
  </section>

  <!-- Raspberry Pi Live Stats -->
  <section id="pi-stats" class="section bg-white dark:bg-gray-900 rounded-lg shadow-lg p-6 mb-8 border-l-4 border-red-600">
    <h2 class="text-3xl font-semibold mb-4 text-red-600 dark:text-red-400">Raspberry Pi Live Stats</h2>

    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 text-base sm:text-lg mb-4">
      <p><span class="font-semibold">Disk (/):</span> <span id="pi-disk">--%</span></p>
      <p><span class="font-semibold">Temp:</span> <span id="pi-temp">--¬∞C</span></p>
      <p><span class="font-semibold">Load (1/5/15):</span> <span id="pi-load">-- -- --</span></p>
      <p><span class="font-semibold">Uptime:</span> <span id="pi-uptime">--</span></p>
    </div>

    <!-- CPU Progress -->
    <div class="mb-4">
      <div class="flex justify-between text-sm mb-1">
        <span class="font-semibold">CPU Usage</span>
        <span id="pi-cpu">--%</span>
      </div>
      <div class="w-full bg-gray-200 dark:bg-gray-800 rounded-full h-4 overflow-hidden">
        <div id="pi-cpu-bar" class="h-4 transition-all duration-500" style="width:0%;background:linear-gradient(90deg,green,yellow,red)"></div>
      </div>
    </div>

    <!-- RAM Progress -->
    <div>
      <div class="flex justify-between text-sm mb-1">
        <span class="font-semibold">RAM Usage</span>
        <span id="pi-ram">--%</span>
      </div>
      <div class="w-full bg-gray-200 dark:bg-gray-800 rounded-full h-4 overflow-hidden">
        <div id="pi-ram-bar" class="h-4 transition-all duration-500" style="width:0%;background:linear-gradient(90deg,green,yellow,red)"></div>
      </div>
    </div>
  </section>

  <!-- Contact -->
  <section id="contact" class="section bg-white dark:bg-gray-900 rounded-lg shadow-lg p-6 mb-8 border-l-4 border-red-600">
    <h2 class="text-3xl font-semibold mb-4 text-red-600 dark:text-red-400">Contact</h2>
    <p class="text-base sm:text-lg mb-4">
      Email: <a href="mailto:wynand.0128@gmail.com" class="text-red-600 hover:underline">wynand.0128@gmail.com</a><br/>
      Phone: 076 255 3289<br/>
      LinkedIn: <a href="https://www.linkedin.com/in/wynand-janse-van-rensburg-953539352/" target="_blank" rel="noopener noreferrer" class="text-red-600 hover:underline">linkedin.com/in/wynand-janse-van-rensburg</a>
    </p>
    <div class="flex space-x-4 justify-center mt-4">
      <a href="https://github.com/WynandJvR" target="_blank" rel="noopener noreferrer" class="transform hover:scale-110 transition-transform">
        <svg class="w-8 h-8 text-gray-800 dark:text-red-400 hover:text-red-600" fill="currentColor" viewBox="0 0 24 24">
          <path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61-.546-1.385-1.335-1.755-1.335-1.755-1.087-.744.083-.729.083-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path>
        </svg>
      </a>
      <a href="https://www.linkedin.com/in/wynand-janse-van-rensburg-953539352/" target="_blank" rel="noopener noreferrer" class="transform hover:scale-110 transition-transform">
        <svg class="w-8 h-8 text-gray-800 dark:text-red-400 hover:text-red-600" fill="currentColor" viewBox="0 0 24 24">
          <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path>
        </svg>
      </a>
    </div>
  </section>

</div>

<!-- Footer -->
<footer class="bg-black text-white text-center py-4">
  <p>¬© 2025 Wynand Janse van Rensburg | Powered by Raspberry Pi</p>
</footer>

<script>
// Utility functions
const $ = id => document.getElementById(id);
const state = { 
  isDark: localStorage.getItem('darkMode') === 'true', 
  handleY: 140, 
  isPulling: false 
};

// Dark mode functionality
function toggleDarkMode() {
  state.isDark = !state.isDark;
  document.documentElement.classList.toggle('dark', state.isDark);
  localStorage.setItem('darkMode', state.isDark);
  const toggle = $('mobileToggle');
  if (toggle) toggle.checked = state.isDark;
}

// Initialize dark mode
if (state.isDark) {
  document.documentElement.classList.add('dark');
  const toggle = $('mobileToggle');
  if (toggle) toggle.checked = true;
}

// Event listeners
const mobileToggle = $('mobileToggle');
if (mobileToggle) {
  mobileToggle.addEventListener('change', e => {
    state.isDark = e.target.checked;
    document.documentElement.classList.toggle('dark', state.isDark);
    localStorage.setItem('darkMode', state.isDark);
  });
}

const menuToggle = $('menuToggle');
if (menuToggle) {
  menuToggle.addEventListener('click', () => {
    const navLinks = $('navLinks');
    if (navLinks) navLinks.classList.toggle('hidden');
  });
}

// Typed.js animation
document.addEventListener('DOMContentLoaded', () => {
  if (typeof Typed !== 'undefined' && $('typed-text')) {
    new Typed('#typed-text', {
      strings: ['Wynand Janse van Rensburg', 'IT Developer & Innovator', 'Building the Future with Code'],
      typeSpeed: 40,
      backSpeed: 30,
      loop: true
    });
  }
});

// Intersection Observer for animations
const observer = new IntersectionObserver(entries => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      entry.target.classList.add('visible');
    }
  });
}, { threshold: 0.1 });

document.querySelectorAll('.section').forEach(section => observer.observe(section));

// Lamp cord functionality
const svg = $('cordSvg');
const cord = $('cordWithHandle');

if (svg && cord) {
  const updateCord = () => {
    cord.setAttribute('d', `M 24 0 L 24 ${state.handleY - 12} M 12 ${state.handleY} A 12 12 0 1 1 36 ${state.handleY} A 12 12 0 1 1 12 ${state.handleY}`);
  };
  
  const getY = e => Math.max(140, Math.min(280, (e.touches?.[0] || e).clientY - svg.getBoundingClientRect().top));
  
  const startPull = e => {
    e.preventDefault();
    state.isPulling = true;
    state.handleY = getY(e);
    updateCord();
  };
  
  const duringPull = e => {
    if (state.isPulling) {
      e.preventDefault();
      state.handleY = getY(e);
      updateCord();
    }
  };
  
  const endPull = () => {
    if (state.isPulling) {
      state.isPulling = false;
      if (state.handleY > 180) toggleDarkMode();
    }
  };
  
  // Mouse events
  svg.addEventListener('mousedown', startPull);
  window.addEventListener('mousemove', duringPull);
  window.addEventListener('mouseup', endPull);
  
  // Touch events
  svg.addEventListener('touchstart', startPull);
  window.addEventListener('touchmove', duringPull);
  window.addEventListener('touchend', endPull);
  
  // Keyboard accessibility
  svg.addEventListener('keydown', e => {
    if (e.key === ' ' || e.key === 'Enter') {
      e.preventDefault();
      toggleDarkMode();
    }
  });
  
  // Animation loop for cord spring-back
  const animate = () => {
    if (!state.isPulling && state.handleY > 140) {
      state.handleY += (140 - state.handleY) * 0.1;
      updateCord();
    }
    requestAnimationFrame(animate);
  };
  
  updateCord();
  animate();
}

// Weather functionality
const weatherMap = {
  clear: { codes: [0, 1], label: "clear sky" },
  cloudy: { codes: [2, 3], label: "cloudy" },
  rain: { codes: [51, 53, 55, 61, 63, 65, 80, 81, 82], label: "rainy" },
  snow: { codes: [71, 73, 75, 77, 85, 86], label: "snowy" },
  thunderstorm: { codes: [95, 96, 99], label: "thunderstorm" }
};

async function reverseGeocode(lat, lon) {
  try {
    const res = await fetch(`https://nominatim.openstreetmap.org/reverse?lat=${lat}&lon=${lon}&format=json`);
    const data = await res.json();
    return data.address?.town || data.address?.city || data.address?.village || data.address?.state || "";
  } catch {
    return "";
  }
}

async function fetchWeather(lat, lon, fallback = '') {
  try {
    const res = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=weather_code,temperature_2m&timezone=auto`);
    const data = await res.json();
    const temp = Math.round(data.current.temperature_2m);
    
    // Remove existing weather classes
    document.body.className = document.body.className.replace(/weather-\w+/g, '');
    
    let label = "unknown weather";
    for (const [type, { codes, label: l }] of Object.entries(weatherMap)) {
      if (codes.includes(data.current.weather_code)) {
        document.body.classList.add(`weather-${type}`);
        label = l;
        break;
      }
    }
    
    const location = fallback || await reverseGeocode(lat, lon);
    const text = `${temp}¬∞C, ${label}${location ? " in " + location : ""}`;
    
    const weatherInfo = $('weather-info');
    const weatherMobile = $('weather-info-mobile');
    if (weatherInfo) weatherInfo.textContent = text;
    if (weatherMobile) weatherMobile.textContent = text;
  } catch {
    const error = "Weather unavailable";
    const weatherInfo = $('weather-info');
    const weatherMobile = $('weather-info-mobile');
    if (weatherInfo) weatherInfo.textContent = error;
    if (weatherMobile) weatherMobile.textContent = error;
  }
}

// Initialize weather
if (navigator.geolocation) {
  navigator.geolocation.getCurrentPosition(
    pos => fetchWeather(pos.coords.latitude, pos.coords.longitude),
    () => fetchWeather(-34.0808, 21.2662, "Riversdale"),
    { timeout: 5000 }
  );
} else {
  fetchWeather(-34.0808, 21.2662, "Riversdale");
}

// Raspberry Pi Stats
function fmtUptime(sec) {
  const d = Math.floor(sec / 86400);
  const h = Math.floor((sec % 86400) / 3600);
  const m = Math.floor((sec % 3600) / 60);
  return `${d}d ${h}h ${m}m`;
}

function animateNumber(id, start, end, duration) {
  const el = $(id);
  if (!el) return;
  
  const startTime = performance.now();
  function update(currentTime) {
    const progress = Math.min((currentTime - startTime) / duration, 1);
    const value = Math.round(start + (end - start) * progress);
    el.textContent = `${value}%`;
    if (progress < 1) requestAnimationFrame(update);
  }
  requestAnimationFrame(update);
}

async function refreshPiStats() {
  try {
    const res = await fetch('/stats', { cache: 'no-store' });
    if (!res.ok) throw new Error(`HTTP ${res.status}`);
    const s = await res.json();

    const cpu = Math.round(s.cpu_usage || 0);
    const ram = Math.round(s.ram_used_pct || 0);
    const disk = Math.round(s.disk_root_used_pct || 0);
    const temp = (s.cpu_temp_c != null) ? `${s.cpu_temp_c.toFixed(1)}¬∞C` : 'N/A';
    const load = Array.isArray(s.load_avg) ? s.load_avg.map(v => v.toFixed(2)).join(' / ') : '--';
    const uptime = fmtUptime(s.uptime_seconds || 0);

    // Update text elements
    const elements = {
      'pi-disk': `${disk}%`,
      'pi-temp': temp,
      'pi-load': load,
      'pi-uptime': uptime
    };
    
    Object.entries(elements).forEach(([id, value]) => {
      const el = $(id);
      if (el) el.textContent = value;
    });

    // Animate numbers
    const cpuEl = $('pi-cpu');
    const ramEl = $('pi-ram');
    if (cpuEl && ramEl) {
      const currentCpu = parseInt(cpuEl.textContent) || 0;
      const currentRam = parseInt(ramEl.textContent) || 0;
      
      animateNumber('pi-cpu', currentCpu, cpu, 500);
      animateNumber('pi-ram', currentRam, ram, 500);
    }

    // Update progress bars
    const cpuBar = $('pi-cpu-bar');
    const ramBar = $('pi-ram-bar');
    if (cpuBar) cpuBar.style.width = `${cpu}%`;
    if (ramBar) ramBar.style.width = `${ram}%`;

  } catch (e) {
    console.warn('Failed to fetch Pi stats:', e);
    const cpuEl = $('pi-cpu');
    if (cpuEl) cpuEl.textContent = 'Stats unavailable';
  }
}

// Initialize Pi stats
refreshPiStats();
setInterval(refreshPiStats, 5000);
</script>

</body>
</html>